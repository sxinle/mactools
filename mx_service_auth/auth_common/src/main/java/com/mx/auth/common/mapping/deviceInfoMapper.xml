<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mx.auth.common.dao.DeviceInfoDao">
    <!-- ****************管理工具使用SQL********************************** -->
    <select id="getDeviceInfo" resultType="com.mx.auth.common.model.DeviceInfo">
        select * from te_device_info
        where 1=1
        <if test="product_id != null and product_id != ''">
            and product_id = #{product_id}
        </if>
        <if test="device_no != null and device_no != ''">
            and device_no = #{device_no}
        </if>
        <if test="vin != null and vin != ''">
            and vin = #{vin}
        </if>
        <if test="user_name != null and user_name != ''">
            and user_name = #{user_name}
        </if>
        <if test="user_name != null and user_name != ''">
            and user_name = #{user_name}
        </if>
        <if test="mobile_phone != null and mobile_phone != ''">
            and mobile_phone = #{mobile_phone}
        </if>
    </select>

    <update id="updateDeviceUserInfo">
        update te_device_info set
        user_name = #{user_name},
        card_no = #{card_no},
        gender = #{gender},
        mobile_phone = #{mobile_phone},
        fixed_phone = #{fixed_phone},
        address = #{address},
        mail = #{mail}
        where 1=1
        <if test="product_id != null and product_id != ''">
            AND product_id = #{product_id}
        </if>
        <if test="device_no != null and device_no != ''">
            AND device_no = #{device_no}
        </if>
        <if test="vin != null and vin != ''">
            AND vin = #{vin}
        </if>
    </update>
    <!-- ****************管理工具使用SQL********************************** -->
    <!-- ****************更换导航机使用SQL********************************** -->
    <select id="selectDeviceNoByVin" resultType="String">
        select device_no from te_device_info
        where vin = #{vin}
        and product_id = #{product_id}
    </select>
    <select id="selectDeviceNoCount" resultType="int">
        select count(*) from te_device_info
        where device_no = #{device_no}
        and product_id = #{product_id}
    </select>

    <update id="updateDeviceInfoByChangeDevice">
        update te_device_info set
        device_no = #{new_device_no}
        where device_no = #{old_device_no}
        and product_id = #{product_id}
    </update>
    <!-- ****************更换导航机使用SQL********************************** -->
    <select id="findByExample" resultType="com.mx.auth.common.model.DeviceInfo">
        SELECT * FROM te_device_info
        WHERE device_no = #{device_no} AND product_id = #{product_id}
    </select>

    <select id="checkDeviceNo" resultType="java.lang.Integer">
        select count(*) from te_device_info
        where device_no = #{device_no} and product_id=#{product_id}
    </select>
    <select id="checkVin" resultType="java.lang.Integer">
        select count(*) from te_device_info
        where vin = #{vin} and product_id = #{product_id}
    </select>

    <select id="getDeviceUserInfo" resultType="com.mx.auth.common.model.DeviceInfo">
        select * from te_device_info
        where 1=1
        <if test="vin != null and vin != ''">
            and vin = #{vin}
        </if>
        <if test="device_no != null and device_no != ''">
            and device_no = #{device_no}
        </if>
    </select>

    <insert id="insertDeviceUser">
        insert into te_device_info(
        vin,
        product_id,
        device_no,
        user_name,
        card_no,
        mobile_phone,
        fixed_phone,
        gender,
        address,
        mail,
        create_time,
        scheme_id,
        oem_id
        )
        values(
        #{vin},
        #{product_id},
        #{device_no},
        #{user_name},
        #{card_no},
        #{mobile_phone},
        #{fixed_phone},
        #{gender},
        #{address},
        #{mail},
        now(),
        #{scheme_id},
        #{oem_id}
        )
    </insert>

    <select id="selectVin" resultType="String">
        select vin from te_device_info
        where device_no = #{device_no}
    </select>


    <select id="getDeviceUserByDevice" resultType="com.mx.auth.common.model.Activate">
        select * from te_device_info
        where device_no = #{device_no}
    </select>

</mapper>

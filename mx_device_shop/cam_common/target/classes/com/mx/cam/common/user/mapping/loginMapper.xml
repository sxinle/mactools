<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mx.cam.common.user.dao.LoginDao">

    
    <select id="findMenusByRoleId" resultType="com.mx.cam.common.user.model.Menu">
       SELECT
			*
		FROM
			(
				(
					SELECT
						t2.*
					FROM
						tr_role_menu t1,
						te_menus t2
					WHERE
						t1.role_id IN 
						<foreach  item="item" collection="array" open="(" separator=","  close=")">
							#{item}
						</foreach>
					AND t1.menu_id = t2.id
				)
				UNION
					(
						SELECT
							t4.*
						FROM
							tr_group_role t3,
							te_menus t4,
							tr_role_menu t5
						WHERE
							t3.group_id IN 
							<foreach  item="item" collection="array" open="(" separator=","  close=")">
								#{item}
							</foreach>
						AND t3.role_id = t5.role_id
						AND t5.menu_id = t4.id
					)
			) t6
		ORDER BY
			t6.sort
    </select>
    
    <select id="findAllMenus" resultType="com.mx.cam.common.user.model.Menu">
        SELECT * FROM te_menus order by sort
    </select>
    
</mapper>

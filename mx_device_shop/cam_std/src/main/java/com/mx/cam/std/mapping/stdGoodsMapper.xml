<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mx.cam.std.dao.StdGoodsDao">

	<!-- 查询商品信息 -->
    <select id="getGoodsManage" resultType="com.mx.cam.std.model.Goods">
        select g.*, 
        	   (case g.group_flag WHEN '0' then '非组合' WHEN '1' then '组合' else '' end) as group_flag_name
        from std_goods g
        where 1=1 
        <if test = "goods_id != null and goods_id != ''">
           and g.goods_id = #{goods_id}
        </if>
        <if test = "goods_name != null and goods_name != ''">
           and g.goods_name like "%"#{goods_name}"%"
        </if>
        <if test = "product_id != null and product_id != ''">
           and g.product_id = #{product_id}
        </if>
        <if test = "region_code != null and region_code != ''">
           and g.region_code = #{region_code}
        </if>
        <if test = "region_name != null and region_name != ''">
           and g.region_name like "%"#{region_name}"%"
        </if>
        <if test = "price_info != null and price_info != ''">
           and g.price_info like "%"#{price_info}"%"
        </if>
        <if test = "group_flag != null and group_flag != ''">
           and g.group_flag = #{group_flag}
        </if>
        <if test = "up_down_flag != null and up_down_flag != ''">
           and g.up_down_flag = #{up_down_flag}
        </if>
        <if test = "sub_goods_id != null and sub_goods_id != ''">
           and g.goods_id != #{sub_goods_id}
        </if>

    </select>
    
    <!-- 删除商品 -->
    <delete id="deleteGoodsManage">
		delete from std_goods
		where goods_id in 
 		<foreach  item="item" collection="array" open="(" separator=","  close=")">
			#{item}
		</foreach>
	</delete>
    
    <!-- 添加商品信息 -->
    <insert id="insertGoods">
    insert into std_goods(
    		goods_id,
    		product_id,
    		goods_name,
    		region_code,
    		region_name,
    		price_info,
    		group_flag,
    		up_down_flag
    	)
    	values(
    		#{goods_id},
    		#{product_id},
    		#{goods_name},
    		#{region_code},
    		#{region_name},
    		#{price_info},
    		#{group_flag},
    		'1'
    	)
    </insert>
    
    <!-- 更新商品上下架状态 -->
    <update id="updateGoodsUpDownFlag">
    	update std_goods set 
    	up_down_flag = #{up_down_flag}
    	where goods_id = #{goods_id}
    </update>
    
    <!-- 查询商品明细 -->
    <select id="getGoodsItem" resultType="com.mx.cam.std.model.Goods">
		select g.*
        from std_goods g
        where g.goods_id = #{goods_id}
    </select>
    
    <!-- 编辑商品时更新商品信息 -->
    <update id="updateGoods">
    	update std_goods set 
    	product_id = #{product_id},
    	goods_name = #{goods_name},
    	region_code = #{region_code},
    	region_name = #{region_name},
    	price_info = #{price_info},
    	group_flag = #{group_flag}
    	where goods_id = #{goods_id}
    </update>

</mapper>